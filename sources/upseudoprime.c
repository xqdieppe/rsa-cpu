#include "rsa-cpu.h"

uint32_t upseudoprime_pretest(uint32_t *prime, uint32_t number, size_t bits) {
	u(zero, bits);
	u(tmpdiv, bits); u(tmpmod, bits);
	u(divisor, bits); divisor[0] = number;
	udivmod(prime, divisor, tmpdiv, tmpmod, bits);
	return (ueq(tmpmod, zero, bits));
}

uint32_t upseudoprime_test(uint32_t *prime, size_t bits) {
	if (upseudoprime_pretest(prime, 2, bits)) return (0);
	if (upseudoprime_pretest(prime, 3, bits)) return (0);
	if (upseudoprime_pretest(prime, 5, bits)) return (0);
	if (upseudoprime_pretest(prime, 7, bits)) return (0);
	if (upseudoprime_pretest(prime, 11, bits)) return (0);
	if (upseudoprime_pretest(prime, 13, bits)) return (0);
	if (upseudoprime_pretest(prime, 17, bits)) return (0);
	if (upseudoprime_pretest(prime, 19, bits)) return (0);
	if (upseudoprime_pretest(prime, 23, bits)) return (0);
	if (upseudoprime_pretest(prime, 29, bits)) return (0);
	if (upseudoprime_pretest(prime, 31, bits)) return (0);
	if (upseudoprime_pretest(prime, 37, bits)) return (0);
	if (upseudoprime_pretest(prime, 41, bits)) return (0);
	if (upseudoprime_pretest(prime, 43, bits)) return (0);
	if (upseudoprime_pretest(prime, 47, bits)) return (0);
	if (upseudoprime_pretest(prime, 53, bits)) return (0);
	if (upseudoprime_pretest(prime, 59, bits)) return (0);
	if (upseudoprime_pretest(prime, 61, bits)) return (0);
	if (upseudoprime_pretest(prime, 67, bits)) return (0);
	if (upseudoprime_pretest(prime, 71, bits)) return (0);
	if (upseudoprime_pretest(prime, 73, bits)) return (0);
	if (upseudoprime_pretest(prime, 79, bits)) return (0);
	if (upseudoprime_pretest(prime, 83, bits)) return (0);
	if (upseudoprime_pretest(prime, 89, bits)) return (0);
	if (upseudoprime_pretest(prime, 97, bits)) return (0);
	if (upseudoprime_pretest(prime, 101, bits)) return (0);
	if (upseudoprime_pretest(prime, 103, bits)) return (0);
	if (upseudoprime_pretest(prime, 107, bits)) return (0);
	if (upseudoprime_pretest(prime, 109, bits)) return (0);
	if (upseudoprime_pretest(prime, 113, bits)) return (0);
	if (upseudoprime_pretest(prime, 127, bits)) return (0);
	if (upseudoprime_pretest(prime, 131, bits)) return (0);
	if (upseudoprime_pretest(prime, 137, bits)) return (0);
	if (upseudoprime_pretest(prime, 139, bits)) return (0);
	if (upseudoprime_pretest(prime, 149, bits)) return (0);
	if (upseudoprime_pretest(prime, 151, bits)) return (0);
	if (upseudoprime_pretest(prime, 157, bits)) return (0);
	if (upseudoprime_pretest(prime, 163, bits)) return (0);
	if (upseudoprime_pretest(prime, 167, bits)) return (0);
	if (upseudoprime_pretest(prime, 173, bits)) return (0);
	if (upseudoprime_pretest(prime, 179, bits)) return (0);
	if (upseudoprime_pretest(prime, 181, bits)) return (0);
	if (upseudoprime_pretest(prime, 191, bits)) return (0);
	if (upseudoprime_pretest(prime, 193, bits)) return (0);
	if (upseudoprime_pretest(prime, 197, bits)) return (0);
	if (upseudoprime_pretest(prime, 199, bits)) return (0);
	if (upseudoprime_pretest(prime, 211, bits)) return (0);
	if (upseudoprime_pretest(prime, 223, bits)) return (0);
	if (upseudoprime_pretest(prime, 227, bits)) return (0);
	if (upseudoprime_pretest(prime, 229, bits)) return (0);
	if (upseudoprime_pretest(prime, 233, bits)) return (0);
	if (upseudoprime_pretest(prime, 239, bits)) return (0);
	if (upseudoprime_pretest(prime, 241, bits)) return (0);
	if (upseudoprime_pretest(prime, 251, bits)) return (0);
	if (upseudoprime_pretest(prime, 257, bits)) return (0);
	if (upseudoprime_pretest(prime, 263, bits)) return (0);
	if (upseudoprime_pretest(prime, 269, bits)) return (0);
	if (upseudoprime_pretest(prime, 271, bits)) return (0);
	if (upseudoprime_pretest(prime, 277, bits)) return (0);
	if (upseudoprime_pretest(prime, 281, bits)) return (0);
	if (upseudoprime_pretest(prime, 283, bits)) return (0);
	if (upseudoprime_pretest(prime, 293, bits)) return (0);
	if (upseudoprime_pretest(prime, 307, bits)) return (0);
	if (upseudoprime_pretest(prime, 311, bits)) return (0);
	if (upseudoprime_pretest(prime, 313, bits)) return (0);
	if (upseudoprime_pretest(prime, 317, bits)) return (0);
	if (upseudoprime_pretest(prime, 331, bits)) return (0);
	if (upseudoprime_pretest(prime, 337, bits)) return (0);
	if (upseudoprime_pretest(prime, 347, bits)) return (0);
	if (upseudoprime_pretest(prime, 349, bits)) return (0);
	if (upseudoprime_pretest(prime, 353, bits)) return (0);
	if (upseudoprime_pretest(prime, 359, bits)) return (0);
	if (upseudoprime_pretest(prime, 367, bits)) return (0);
	if (upseudoprime_pretest(prime, 373, bits)) return (0);
	if (upseudoprime_pretest(prime, 379, bits)) return (0);
	if (upseudoprime_pretest(prime, 383, bits)) return (0);
	if (upseudoprime_pretest(prime, 389, bits)) return (0);
	if (upseudoprime_pretest(prime, 397, bits)) return (0);
	if (upseudoprime_pretest(prime, 401, bits)) return (0);
	if (upseudoprime_pretest(prime, 409, bits)) return (0);
	if (upseudoprime_pretest(prime, 419, bits)) return (0);
	if (upseudoprime_pretest(prime, 421, bits)) return (0);
	if (upseudoprime_pretest(prime, 431, bits)) return (0);
	if (upseudoprime_pretest(prime, 433, bits)) return (0);
	if (upseudoprime_pretest(prime, 439, bits)) return (0);
	if (upseudoprime_pretest(prime, 443, bits)) return (0);
	if (upseudoprime_pretest(prime, 449, bits)) return (0);
	if (upseudoprime_pretest(prime, 457, bits)) return (0);
	if (upseudoprime_pretest(prime, 461, bits)) return (0);
	if (upseudoprime_pretest(prime, 463, bits)) return (0);
	if (upseudoprime_pretest(prime, 467, bits)) return (0);
	if (upseudoprime_pretest(prime, 479, bits)) return (0);
	if (upseudoprime_pretest(prime, 487, bits)) return (0);
	if (upseudoprime_pretest(prime, 491, bits)) return (0);
	if (upseudoprime_pretest(prime, 499, bits)) return (0);
	if (upseudoprime_pretest(prime, 503, bits)) return (0);
	if (upseudoprime_pretest(prime, 509, bits)) return (0);
	if (upseudoprime_pretest(prime, 521, bits)) return (0);
	if (upseudoprime_pretest(prime, 523, bits)) return (0);
	if (upseudoprime_pretest(prime, 541, bits)) return (0);
	if (upseudoprime_pretest(prime, 547, bits)) return (0);
	if (upseudoprime_pretest(prime, 557, bits)) return (0);
	if (upseudoprime_pretest(prime, 563, bits)) return (0);
	if (upseudoprime_pretest(prime, 569, bits)) return (0);
	if (upseudoprime_pretest(prime, 571, bits)) return (0);
	if (upseudoprime_pretest(prime, 577, bits)) return (0);
	if (upseudoprime_pretest(prime, 587, bits)) return (0);
	if (upseudoprime_pretest(prime, 593, bits)) return (0);
	if (upseudoprime_pretest(prime, 599, bits)) return (0);
	if (upseudoprime_pretest(prime, 601, bits)) return (0);
	if (upseudoprime_pretest(prime, 607, bits)) return (0);
	if (upseudoprime_pretest(prime, 613, bits)) return (0);
	if (upseudoprime_pretest(prime, 617, bits)) return (0);
	if (upseudoprime_pretest(prime, 619, bits)) return (0);
	if (upseudoprime_pretest(prime, 631, bits)) return (0);
	if (upseudoprime_pretest(prime, 641, bits)) return (0);
	if (upseudoprime_pretest(prime, 643, bits)) return (0);
	if (upseudoprime_pretest(prime, 647, bits)) return (0);
	if (upseudoprime_pretest(prime, 653, bits)) return (0);
	if (upseudoprime_pretest(prime, 659, bits)) return (0);
	if (upseudoprime_pretest(prime, 661, bits)) return (0);
	if (upseudoprime_pretest(prime, 673, bits)) return (0);
	if (upseudoprime_pretest(prime, 677, bits)) return (0);
	if (upseudoprime_pretest(prime, 683, bits)) return (0);
	if (upseudoprime_pretest(prime, 691, bits)) return (0);
	if (upseudoprime_pretest(prime, 701, bits)) return (0);
	if (upseudoprime_pretest(prime, 709, bits)) return (0);
	if (upseudoprime_pretest(prime, 719, bits)) return (0);
	if (upseudoprime_pretest(prime, 727, bits)) return (0);
	if (upseudoprime_pretest(prime, 733, bits)) return (0);
	if (upseudoprime_pretest(prime, 739, bits)) return (0);
	if (upseudoprime_pretest(prime, 743, bits)) return (0);
	if (upseudoprime_pretest(prime, 751, bits)) return (0);
	if (upseudoprime_pretest(prime, 757, bits)) return (0);
	if (upseudoprime_pretest(prime, 761, bits)) return (0);
	if (upseudoprime_pretest(prime, 769, bits)) return (0);
	if (upseudoprime_pretest(prime, 773, bits)) return (0);
	if (upseudoprime_pretest(prime, 787, bits)) return (0);
	if (upseudoprime_pretest(prime, 797, bits)) return (0);
	if (upseudoprime_pretest(prime, 809, bits)) return (0);
	if (upseudoprime_pretest(prime, 811, bits)) return (0);
	if (upseudoprime_pretest(prime, 821, bits)) return (0);
	if (upseudoprime_pretest(prime, 823, bits)) return (0);
	if (upseudoprime_pretest(prime, 827, bits)) return (0);
	if (upseudoprime_pretest(prime, 829, bits)) return (0);
	if (upseudoprime_pretest(prime, 839, bits)) return (0);
	if (upseudoprime_pretest(prime, 853, bits)) return (0);
	if (upseudoprime_pretest(prime, 857, bits)) return (0);
	if (upseudoprime_pretest(prime, 859, bits)) return (0);
	if (upseudoprime_pretest(prime, 863, bits)) return (0);
	if (upseudoprime_pretest(prime, 877, bits)) return (0);
	if (upseudoprime_pretest(prime, 881, bits)) return (0);
	if (upseudoprime_pretest(prime, 883, bits)) return (0);
	if (upseudoprime_pretest(prime, 887, bits)) return (0);
	if (upseudoprime_pretest(prime, 907, bits)) return (0);
	if (upseudoprime_pretest(prime, 911, bits)) return (0);
	if (upseudoprime_pretest(prime, 919, bits)) return (0);
	if (upseudoprime_pretest(prime, 929, bits)) return (0);
	if (upseudoprime_pretest(prime, 937, bits)) return (0);
	if (upseudoprime_pretest(prime, 941, bits)) return (0);
	if (upseudoprime_pretest(prime, 947, bits)) return (0);
	if (upseudoprime_pretest(prime, 953, bits)) return (0);
	if (upseudoprime_pretest(prime, 967, bits)) return (0);
	if (upseudoprime_pretest(prime, 971, bits)) return (0);
	if (upseudoprime_pretest(prime, 977, bits)) return (0);
	if (upseudoprime_pretest(prime, 983, bits)) return (0);
	if (upseudoprime_pretest(prime, 991, bits)) return (0);
	if (upseudoprime_pretest(prime, 997, bits)) return (0);
	if (upseudoprime_pretest(prime, 1009, bits)) return (0);
	if (upseudoprime_pretest(prime, 1013, bits)) return (0);
	if (upseudoprime_pretest(prime, 1019, bits)) return (0);
	if (upseudoprime_pretest(prime, 1021, bits)) return (0);
	if (upseudoprime_pretest(prime, 1031, bits)) return (0);
	if (upseudoprime_pretest(prime, 1033, bits)) return (0);
	if (upseudoprime_pretest(prime, 1039, bits)) return (0);
	if (upseudoprime_pretest(prime, 1049, bits)) return (0);
	if (upseudoprime_pretest(prime, 1051, bits)) return (0);
	if (upseudoprime_pretest(prime, 1061, bits)) return (0);
	if (upseudoprime_pretest(prime, 1063, bits)) return (0);
	if (upseudoprime_pretest(prime, 1069, bits)) return (0);
	if (upseudoprime_pretest(prime, 1087, bits)) return (0);
	if (upseudoprime_pretest(prime, 1091, bits)) return (0);
	if (upseudoprime_pretest(prime, 1093, bits)) return (0);
	if (upseudoprime_pretest(prime, 1097, bits)) return (0);
	if (upseudoprime_pretest(prime, 1103, bits)) return (0);
	if (upseudoprime_pretest(prime, 1109, bits)) return (0);
	if (upseudoprime_pretest(prime, 1117, bits)) return (0);
	if (upseudoprime_pretest(prime, 1123, bits)) return (0);
	if (upseudoprime_pretest(prime, 1129, bits)) return (0);
	if (upseudoprime_pretest(prime, 1151, bits)) return (0);
	if (upseudoprime_pretest(prime, 1153, bits)) return (0);
	if (upseudoprime_pretest(prime, 1163, bits)) return (0);
	if (upseudoprime_pretest(prime, 1171, bits)) return (0);
	if (upseudoprime_pretest(prime, 1181, bits)) return (0);
	if (upseudoprime_pretest(prime, 1187, bits)) return (0);
	if (upseudoprime_pretest(prime, 1193, bits)) return (0);
	if (upseudoprime_pretest(prime, 1201, bits)) return (0);
	if (upseudoprime_pretest(prime, 1213, bits)) return (0);
	if (upseudoprime_pretest(prime, 1217, bits)) return (0);
	if (upseudoprime_pretest(prime, 1223, bits)) return (0);
	if (upseudoprime_pretest(prime, 1229, bits)) return (0);
	if (upseudoprime_pretest(prime, 1231, bits)) return (0);
	if (upseudoprime_pretest(prime, 1237, bits)) return (0);
	if (upseudoprime_pretest(prime, 1249, bits)) return (0);
	if (upseudoprime_pretest(prime, 1259, bits)) return (0);
	if (upseudoprime_pretest(prime, 1277, bits)) return (0);
	if (upseudoprime_pretest(prime, 1279, bits)) return (0);
	if (upseudoprime_pretest(prime, 1283, bits)) return (0);
	if (upseudoprime_pretest(prime, 1289, bits)) return (0);
	if (upseudoprime_pretest(prime, 1291, bits)) return (0);
	if (upseudoprime_pretest(prime, 1297, bits)) return (0);
	if (upseudoprime_pretest(prime, 1301, bits)) return (0);
	if (upseudoprime_pretest(prime, 1303, bits)) return (0);
	if (upseudoprime_pretest(prime, 1307, bits)) return (0);
	if (upseudoprime_pretest(prime, 1319, bits)) return (0);
	if (upseudoprime_pretest(prime, 1321, bits)) return (0);
	if (upseudoprime_pretest(prime, 1327, bits)) return (0);
	if (upseudoprime_pretest(prime, 1361, bits)) return (0);
	if (upseudoprime_pretest(prime, 1367, bits)) return (0);
	if (upseudoprime_pretest(prime, 1373, bits)) return (0);
	if (upseudoprime_pretest(prime, 1381, bits)) return (0);
	if (upseudoprime_pretest(prime, 1399, bits)) return (0);
	if (upseudoprime_pretest(prime, 1409, bits)) return (0);
	if (upseudoprime_pretest(prime, 1423, bits)) return (0);
	if (upseudoprime_pretest(prime, 1427, bits)) return (0);
	if (upseudoprime_pretest(prime, 1429, bits)) return (0);
	if (upseudoprime_pretest(prime, 1433, bits)) return (0);
	if (upseudoprime_pretest(prime, 1439, bits)) return (0);
	if (upseudoprime_pretest(prime, 1447, bits)) return (0);
	if (upseudoprime_pretest(prime, 1451, bits)) return (0);
	if (upseudoprime_pretest(prime, 1453, bits)) return (0);
	if (upseudoprime_pretest(prime, 1459, bits)) return (0);
	if (upseudoprime_pretest(prime, 1471, bits)) return (0);
	if (upseudoprime_pretest(prime, 1481, bits)) return (0);
	if (upseudoprime_pretest(prime, 1483, bits)) return (0);
	if (upseudoprime_pretest(prime, 1487, bits)) return (0);
	if (upseudoprime_pretest(prime, 1489, bits)) return (0);
	if (upseudoprime_pretest(prime, 1493, bits)) return (0);
	if (upseudoprime_pretest(prime, 1499, bits)) return (0);
	if (upseudoprime_pretest(prime, 1511, bits)) return (0);
	if (upseudoprime_pretest(prime, 1523, bits)) return (0);
	if (upseudoprime_pretest(prime, 1531, bits)) return (0);
	if (upseudoprime_pretest(prime, 1543, bits)) return (0);
	if (upseudoprime_pretest(prime, 1549, bits)) return (0);
	if (upseudoprime_pretest(prime, 1553, bits)) return (0);
	if (upseudoprime_pretest(prime, 1559, bits)) return (0);
	if (upseudoprime_pretest(prime, 1567, bits)) return (0);
	if (upseudoprime_pretest(prime, 1571, bits)) return (0);
	if (upseudoprime_pretest(prime, 1579, bits)) return (0);
	if (upseudoprime_pretest(prime, 1583, bits)) return (0);
	if (upseudoprime_pretest(prime, 1597, bits)) return (0);
	if (upseudoprime_pretest(prime, 1601, bits)) return (0);
	if (upseudoprime_pretest(prime, 1607, bits)) return (0);
	if (upseudoprime_pretest(prime, 1609, bits)) return (0);
	if (upseudoprime_pretest(prime, 1613, bits)) return (0);
	if (upseudoprime_pretest(prime, 1619, bits)) return (0);
	if (upseudoprime_pretest(prime, 1621, bits)) return (0);
	if (upseudoprime_pretest(prime, 1627, bits)) return (0);
	if (upseudoprime_pretest(prime, 1637, bits)) return (0);
	if (upseudoprime_pretest(prime, 1657, bits)) return (0);
	if (upseudoprime_pretest(prime, 1663, bits)) return (0);
	if (upseudoprime_pretest(prime, 1667, bits)) return (0);
	if (upseudoprime_pretest(prime, 1669, bits)) return (0);
	if (upseudoprime_pretest(prime, 1693, bits)) return (0);
	if (upseudoprime_pretest(prime, 1697, bits)) return (0);
	if (upseudoprime_pretest(prime, 1699, bits)) return (0);
	if (upseudoprime_pretest(prime, 1709, bits)) return (0);
	if (upseudoprime_pretest(prime, 1721, bits)) return (0);
	if (upseudoprime_pretest(prime, 1723, bits)) return (0);
	if (upseudoprime_pretest(prime, 1733, bits)) return (0);
	if (upseudoprime_pretest(prime, 1741, bits)) return (0);
	if (upseudoprime_pretest(prime, 1747, bits)) return (0);
	if (upseudoprime_pretest(prime, 1753, bits)) return (0);
	if (upseudoprime_pretest(prime, 1759, bits)) return (0);
	if (upseudoprime_pretest(prime, 1777, bits)) return (0);
	if (upseudoprime_pretest(prime, 1783, bits)) return (0);
	if (upseudoprime_pretest(prime, 1787, bits)) return (0);
	if (upseudoprime_pretest(prime, 1789, bits)) return (0);
	if (upseudoprime_pretest(prime, 1801, bits)) return (0);
	if (upseudoprime_pretest(prime, 1811, bits)) return (0);
	if (upseudoprime_pretest(prime, 1823, bits)) return (0);
	if (upseudoprime_pretest(prime, 1831, bits)) return (0);
	if (upseudoprime_pretest(prime, 1847, bits)) return (0);
	if (upseudoprime_pretest(prime, 1861, bits)) return (0);
	if (upseudoprime_pretest(prime, 1867, bits)) return (0);
	if (upseudoprime_pretest(prime, 1871, bits)) return (0);
	if (upseudoprime_pretest(prime, 1873, bits)) return (0);
	if (upseudoprime_pretest(prime, 1877, bits)) return (0);
	if (upseudoprime_pretest(prime, 1879, bits)) return (0);
	if (upseudoprime_pretest(prime, 1889, bits)) return (0);
	if (upseudoprime_pretest(prime, 1901, bits)) return (0);
	if (upseudoprime_pretest(prime, 1907, bits)) return (0);
	if (upseudoprime_pretest(prime, 1913, bits)) return (0);
	if (upseudoprime_pretest(prime, 1931, bits)) return (0);
	if (upseudoprime_pretest(prime, 1933, bits)) return (0);
	if (upseudoprime_pretest(prime, 1949, bits)) return (0);
	if (upseudoprime_pretest(prime, 1951, bits)) return (0);
	if (upseudoprime_pretest(prime, 1973, bits)) return (0);
	if (upseudoprime_pretest(prime, 1979, bits)) return (0);
	if (upseudoprime_pretest(prime, 1987, bits)) return (0);
	if (upseudoprime_pretest(prime, 1993, bits)) return (0);
	if (upseudoprime_pretest(prime, 1997, bits)) return (0);
	if (upseudoprime_pretest(prime, 1999, bits)) return (0);
	if (upseudoprime_pretest(prime, 2003, bits)) return (0);
	if (upseudoprime_pretest(prime, 2011, bits)) return (0);
	if (upseudoprime_pretest(prime, 2017, bits)) return (0);
	if (upseudoprime_pretest(prime, 2027, bits)) return (0);
	if (upseudoprime_pretest(prime, 2029, bits)) return (0);
	if (upseudoprime_pretest(prime, 2039, bits)) return (0);
	if (upseudoprime_pretest(prime, 2053, bits)) return (0);
	if (upseudoprime_pretest(prime, 2063, bits)) return (0);
	if (upseudoprime_pretest(prime, 2069, bits)) return (0);
	if (upseudoprime_pretest(prime, 2081, bits)) return (0);
	if (upseudoprime_pretest(prime, 2083, bits)) return (0);
	if (upseudoprime_pretest(prime, 2087, bits)) return (0);
	if (upseudoprime_pretest(prime, 2089, bits)) return (0);
	if (upseudoprime_pretest(prime, 2099, bits)) return (0);
	if (upseudoprime_pretest(prime, 2111, bits)) return (0);
	if (upseudoprime_pretest(prime, 2113, bits)) return (0);
	if (upseudoprime_pretest(prime, 2129, bits)) return (0);
	if (upseudoprime_pretest(prime, 2131, bits)) return (0);
	if (upseudoprime_pretest(prime, 2137, bits)) return (0);
	if (upseudoprime_pretest(prime, 2141, bits)) return (0);
	if (upseudoprime_pretest(prime, 2143, bits)) return (0);
	if (upseudoprime_pretest(prime, 2153, bits)) return (0);
	if (upseudoprime_pretest(prime, 2161, bits)) return (0);
	if (upseudoprime_pretest(prime, 2179, bits)) return (0);
	if (upseudoprime_pretest(prime, 2203, bits)) return (0);
	if (upseudoprime_pretest(prime, 2207, bits)) return (0);
	if (upseudoprime_pretest(prime, 2213, bits)) return (0);
	if (upseudoprime_pretest(prime, 2221, bits)) return (0);
	if (upseudoprime_pretest(prime, 2237, bits)) return (0);
	if (upseudoprime_pretest(prime, 2239, bits)) return (0);
	if (upseudoprime_pretest(prime, 2243, bits)) return (0);
	if (upseudoprime_pretest(prime, 2251, bits)) return (0);
	if (upseudoprime_pretest(prime, 2267, bits)) return (0);
	if (upseudoprime_pretest(prime, 2269, bits)) return (0);
	if (upseudoprime_pretest(prime, 2273, bits)) return (0);
	if (upseudoprime_pretest(prime, 2281, bits)) return (0);
	if (upseudoprime_pretest(prime, 2287, bits)) return (0);
	if (upseudoprime_pretest(prime, 2293, bits)) return (0);
	if (upseudoprime_pretest(prime, 2297, bits)) return (0);
	if (upseudoprime_pretest(prime, 2309, bits)) return (0);
	if (upseudoprime_pretest(prime, 2311, bits)) return (0);
	if (upseudoprime_pretest(prime, 2333, bits)) return (0);
	if (upseudoprime_pretest(prime, 2339, bits)) return (0);
	if (upseudoprime_pretest(prime, 2341, bits)) return (0);
	if (upseudoprime_pretest(prime, 2347, bits)) return (0);
	if (upseudoprime_pretest(prime, 2351, bits)) return (0);
	if (upseudoprime_pretest(prime, 2357, bits)) return (0);
	if (upseudoprime_pretest(prime, 2371, bits)) return (0);
	if (upseudoprime_pretest(prime, 2377, bits)) return (0);
	if (upseudoprime_pretest(prime, 2381, bits)) return (0);
	if (upseudoprime_pretest(prime, 2383, bits)) return (0);
	if (upseudoprime_pretest(prime, 2389, bits)) return (0);
	if (upseudoprime_pretest(prime, 2393, bits)) return (0);
	if (upseudoprime_pretest(prime, 2399, bits)) return (0);
	if (upseudoprime_pretest(prime, 2411, bits)) return (0);
	if (upseudoprime_pretest(prime, 2417, bits)) return (0);
	if (upseudoprime_pretest(prime, 2423, bits)) return (0);
	if (upseudoprime_pretest(prime, 2437, bits)) return (0);
	if (upseudoprime_pretest(prime, 2441, bits)) return (0);
	if (upseudoprime_pretest(prime, 2447, bits)) return (0);
	if (upseudoprime_pretest(prime, 2459, bits)) return (0);
	if (upseudoprime_pretest(prime, 2467, bits)) return (0);
	if (upseudoprime_pretest(prime, 2473, bits)) return (0);
	if (upseudoprime_pretest(prime, 2477, bits)) return (0);
	if (upseudoprime_pretest(prime, 2503, bits)) return (0);
	if (upseudoprime_pretest(prime, 2521, bits)) return (0);
	if (upseudoprime_pretest(prime, 2531, bits)) return (0);
	if (upseudoprime_pretest(prime, 2539, bits)) return (0);
	if (upseudoprime_pretest(prime, 2543, bits)) return (0);
	if (upseudoprime_pretest(prime, 2549, bits)) return (0);
	if (upseudoprime_pretest(prime, 2551, bits)) return (0);
	if (upseudoprime_pretest(prime, 2557, bits)) return (0);
	if (upseudoprime_pretest(prime, 2579, bits)) return (0);
	if (upseudoprime_pretest(prime, 2591, bits)) return (0);
	if (upseudoprime_pretest(prime, 2593, bits)) return (0);
	if (upseudoprime_pretest(prime, 2609, bits)) return (0);
	if (upseudoprime_pretest(prime, 2617, bits)) return (0);
	if (upseudoprime_pretest(prime, 2621, bits)) return (0);
	if (upseudoprime_pretest(prime, 2633, bits)) return (0);
	if (upseudoprime_pretest(prime, 2647, bits)) return (0);
	if (upseudoprime_pretest(prime, 2657, bits)) return (0);
	if (upseudoprime_pretest(prime, 2659, bits)) return (0);
	if (upseudoprime_pretest(prime, 2663, bits)) return (0);
	if (upseudoprime_pretest(prime, 2671, bits)) return (0);
	if (upseudoprime_pretest(prime, 2677, bits)) return (0);
	if (upseudoprime_pretest(prime, 2683, bits)) return (0);
	if (upseudoprime_pretest(prime, 2687, bits)) return (0);
	if (upseudoprime_pretest(prime, 2689, bits)) return (0);
	if (upseudoprime_pretest(prime, 2693, bits)) return (0);
	if (upseudoprime_pretest(prime, 2699, bits)) return (0);
	if (upseudoprime_pretest(prime, 2707, bits)) return (0);
	if (upseudoprime_pretest(prime, 2711, bits)) return (0);
	if (upseudoprime_pretest(prime, 2713, bits)) return (0);
	if (upseudoprime_pretest(prime, 2719, bits)) return (0);
	if (upseudoprime_pretest(prime, 2729, bits)) return (0);
	if (upseudoprime_pretest(prime, 2731, bits)) return (0);
	if (upseudoprime_pretest(prime, 2741, bits)) return (0);
	if (upseudoprime_pretest(prime, 2749, bits)) return (0);
	if (upseudoprime_pretest(prime, 2753, bits)) return (0);
	if (upseudoprime_pretest(prime, 2767, bits)) return (0);
	if (upseudoprime_pretest(prime, 2777, bits)) return (0);
	if (upseudoprime_pretest(prime, 2789, bits)) return (0);
	if (upseudoprime_pretest(prime, 2791, bits)) return (0);
	if (upseudoprime_pretest(prime, 2797, bits)) return (0);
	if (upseudoprime_pretest(prime, 2801, bits)) return (0);
	if (upseudoprime_pretest(prime, 2803, bits)) return (0);
	if (upseudoprime_pretest(prime, 2819, bits)) return (0);
	if (upseudoprime_pretest(prime, 2833, bits)) return (0);
	if (upseudoprime_pretest(prime, 2837, bits)) return (0);
	if (upseudoprime_pretest(prime, 2843, bits)) return (0);
	if (upseudoprime_pretest(prime, 2851, bits)) return (0);
	if (upseudoprime_pretest(prime, 2857, bits)) return (0);
	if (upseudoprime_pretest(prime, 2861, bits)) return (0);
	if (upseudoprime_pretest(prime, 2879, bits)) return (0);
	if (upseudoprime_pretest(prime, 2887, bits)) return (0);
	if (upseudoprime_pretest(prime, 2897, bits)) return (0);
	if (upseudoprime_pretest(prime, 2903, bits)) return (0);
	if (upseudoprime_pretest(prime, 2909, bits)) return (0);
	if (upseudoprime_pretest(prime, 2917, bits)) return (0);
	if (upseudoprime_pretest(prime, 2927, bits)) return (0);
	if (upseudoprime_pretest(prime, 2939, bits)) return (0);
	if (upseudoprime_pretest(prime, 2953, bits)) return (0);
	if (upseudoprime_pretest(prime, 2957, bits)) return (0);
	if (upseudoprime_pretest(prime, 2963, bits)) return (0);
	if (upseudoprime_pretest(prime, 2969, bits)) return (0);
	if (upseudoprime_pretest(prime, 2971, bits)) return (0);
	if (upseudoprime_pretest(prime, 2999, bits)) return (0);
	if (upseudoprime_pretest(prime, 3001, bits)) return (0);
	if (upseudoprime_pretest(prime, 3011, bits)) return (0);
	if (upseudoprime_pretest(prime, 3019, bits)) return (0);
	if (upseudoprime_pretest(prime, 3023, bits)) return (0);
	if (upseudoprime_pretest(prime, 3037, bits)) return (0);
	if (upseudoprime_pretest(prime, 3041, bits)) return (0);
	if (upseudoprime_pretest(prime, 3049, bits)) return (0);
	if (upseudoprime_pretest(prime, 3061, bits)) return (0);
	if (upseudoprime_pretest(prime, 3067, bits)) return (0);
	if (upseudoprime_pretest(prime, 3079, bits)) return (0);
	if (upseudoprime_pretest(prime, 3083, bits)) return (0);
	if (upseudoprime_pretest(prime, 3089, bits)) return (0);
	if (upseudoprime_pretest(prime, 3109, bits)) return (0);
	if (upseudoprime_pretest(prime, 3119, bits)) return (0);
	if (upseudoprime_pretest(prime, 3121, bits)) return (0);
	if (upseudoprime_pretest(prime, 3137, bits)) return (0);
	if (upseudoprime_pretest(prime, 3163, bits)) return (0);
	if (upseudoprime_pretest(prime, 3167, bits)) return (0);
	if (upseudoprime_pretest(prime, 3169, bits)) return (0);
	if (upseudoprime_pretest(prime, 3181, bits)) return (0);
	if (upseudoprime_pretest(prime, 3187, bits)) return (0);
	if (upseudoprime_pretest(prime, 3191, bits)) return (0);
	if (upseudoprime_pretest(prime, 3203, bits)) return (0);
	if (upseudoprime_pretest(prime, 3209, bits)) return (0);
	if (upseudoprime_pretest(prime, 3217, bits)) return (0);
	if (upseudoprime_pretest(prime, 3221, bits)) return (0);
	if (upseudoprime_pretest(prime, 3229, bits)) return (0);
	if (upseudoprime_pretest(prime, 3251, bits)) return (0);
	if (upseudoprime_pretest(prime, 3253, bits)) return (0);
	if (upseudoprime_pretest(prime, 3257, bits)) return (0);
	if (upseudoprime_pretest(prime, 3259, bits)) return (0);
	if (upseudoprime_pretest(prime, 3271, bits)) return (0);
	if (upseudoprime_pretest(prime, 3299, bits)) return (0);
	if (upseudoprime_pretest(prime, 3301, bits)) return (0);
	if (upseudoprime_pretest(prime, 3307, bits)) return (0);
	if (upseudoprime_pretest(prime, 3313, bits)) return (0);
	if (upseudoprime_pretest(prime, 3319, bits)) return (0);
	if (upseudoprime_pretest(prime, 3323, bits)) return (0);
	if (upseudoprime_pretest(prime, 3329, bits)) return (0);
	if (upseudoprime_pretest(prime, 3331, bits)) return (0);
	if (upseudoprime_pretest(prime, 3343, bits)) return (0);
	if (upseudoprime_pretest(prime, 3347, bits)) return (0);
	if (upseudoprime_pretest(prime, 3359, bits)) return (0);
	if (upseudoprime_pretest(prime, 3361, bits)) return (0);
	if (upseudoprime_pretest(prime, 3371, bits)) return (0);
	if (upseudoprime_pretest(prime, 3373, bits)) return (0);
	if (upseudoprime_pretest(prime, 3389, bits)) return (0);
	if (upseudoprime_pretest(prime, 3391, bits)) return (0);
	if (upseudoprime_pretest(prime, 3407, bits)) return (0);
	if (upseudoprime_pretest(prime, 3413, bits)) return (0);
	if (upseudoprime_pretest(prime, 3433, bits)) return (0);
	if (upseudoprime_pretest(prime, 3449, bits)) return (0);
	if (upseudoprime_pretest(prime, 3457, bits)) return (0);
	if (upseudoprime_pretest(prime, 3461, bits)) return (0);
	if (upseudoprime_pretest(prime, 3463, bits)) return (0);
	if (upseudoprime_pretest(prime, 3467, bits)) return (0);
	if (upseudoprime_pretest(prime, 3469, bits)) return (0);
	if (upseudoprime_pretest(prime, 3491, bits)) return (0);
	if (upseudoprime_pretest(prime, 3499, bits)) return (0);
	if (upseudoprime_pretest(prime, 3511, bits)) return (0);
	if (upseudoprime_pretest(prime, 3517, bits)) return (0);
	if (upseudoprime_pretest(prime, 3527, bits)) return (0);
	if (upseudoprime_pretest(prime, 3529, bits)) return (0);
	if (upseudoprime_pretest(prime, 3533, bits)) return (0);
	if (upseudoprime_pretest(prime, 3539, bits)) return (0);
	if (upseudoprime_pretest(prime, 3541, bits)) return (0);
	if (upseudoprime_pretest(prime, 3547, bits)) return (0);
	if (upseudoprime_pretest(prime, 3557, bits)) return (0);
	if (upseudoprime_pretest(prime, 3559, bits)) return (0);
	if (upseudoprime_pretest(prime, 3571, bits)) return (0);
	if (upseudoprime_pretest(prime, 3581, bits)) return (0);
	if (upseudoprime_pretest(prime, 3583, bits)) return (0);
	if (upseudoprime_pretest(prime, 3593, bits)) return (0);
	if (upseudoprime_pretest(prime, 3607, bits)) return (0);
	if (upseudoprime_pretest(prime, 3613, bits)) return (0);
	if (upseudoprime_pretest(prime, 3617, bits)) return (0);
	if (upseudoprime_pretest(prime, 3623, bits)) return (0);
	if (upseudoprime_pretest(prime, 3631, bits)) return (0);
	if (upseudoprime_pretest(prime, 3637, bits)) return (0);
	if (upseudoprime_pretest(prime, 3643, bits)) return (0);
	if (upseudoprime_pretest(prime, 3659, bits)) return (0);
	if (upseudoprime_pretest(prime, 3671, bits)) return (0);
	if (upseudoprime_pretest(prime, 3673, bits)) return (0);
	if (upseudoprime_pretest(prime, 3677, bits)) return (0);
	if (upseudoprime_pretest(prime, 3691, bits)) return (0);
	if (upseudoprime_pretest(prime, 3697, bits)) return (0);
	if (upseudoprime_pretest(prime, 3701, bits)) return (0);
	if (upseudoprime_pretest(prime, 3709, bits)) return (0);
	if (upseudoprime_pretest(prime, 3719, bits)) return (0);
	if (upseudoprime_pretest(prime, 3727, bits)) return (0);
	if (upseudoprime_pretest(prime, 3733, bits)) return (0);
	if (upseudoprime_pretest(prime, 3739, bits)) return (0);
	if (upseudoprime_pretest(prime, 3761, bits)) return (0);
	if (upseudoprime_pretest(prime, 3767, bits)) return (0);
	if (upseudoprime_pretest(prime, 3769, bits)) return (0);
	if (upseudoprime_pretest(prime, 3779, bits)) return (0);
	if (upseudoprime_pretest(prime, 3793, bits)) return (0);
	if (upseudoprime_pretest(prime, 3797, bits)) return (0);
	if (upseudoprime_pretest(prime, 3803, bits)) return (0);
	if (upseudoprime_pretest(prime, 3821, bits)) return (0);
	if (upseudoprime_pretest(prime, 3823, bits)) return (0);
	if (upseudoprime_pretest(prime, 3833, bits)) return (0);
	if (upseudoprime_pretest(prime, 3847, bits)) return (0);
	if (upseudoprime_pretest(prime, 3851, bits)) return (0);
	if (upseudoprime_pretest(prime, 3853, bits)) return (0);
	if (upseudoprime_pretest(prime, 3863, bits)) return (0);
	if (upseudoprime_pretest(prime, 3877, bits)) return (0);
	if (upseudoprime_pretest(prime, 3881, bits)) return (0);
	if (upseudoprime_pretest(prime, 3889, bits)) return (0);
	if (upseudoprime_pretest(prime, 3907, bits)) return (0);
	if (upseudoprime_pretest(prime, 3911, bits)) return (0);
	if (upseudoprime_pretest(prime, 3917, bits)) return (0);
	if (upseudoprime_pretest(prime, 3919, bits)) return (0);
	if (upseudoprime_pretest(prime, 3923, bits)) return (0);
	if (upseudoprime_pretest(prime, 3929, bits)) return (0);
	if (upseudoprime_pretest(prime, 3931, bits)) return (0);
	if (upseudoprime_pretest(prime, 3943, bits)) return (0);
	if (upseudoprime_pretest(prime, 3947, bits)) return (0);
	if (upseudoprime_pretest(prime, 3967, bits)) return (0);
	if (upseudoprime_pretest(prime, 3989, bits)) return (0);
	if (upseudoprime_pretest(prime, 4001, bits)) return (0);
	if (upseudoprime_pretest(prime, 4003, bits)) return (0);
	if (upseudoprime_pretest(prime, 4007, bits)) return (0);
	if (upseudoprime_pretest(prime, 4013, bits)) return (0);
	if (upseudoprime_pretest(prime, 4019, bits)) return (0);
	if (upseudoprime_pretest(prime, 4021, bits)) return (0);
	if (upseudoprime_pretest(prime, 4027, bits)) return (0);
	if (upseudoprime_pretest(prime, 4049, bits)) return (0);
	if (upseudoprime_pretest(prime, 4051, bits)) return (0);
	if (upseudoprime_pretest(prime, 4057, bits)) return (0);
	if (upseudoprime_pretest(prime, 4073, bits)) return (0);
	if (upseudoprime_pretest(prime, 4079, bits)) return (0);
	if (upseudoprime_pretest(prime, 4091, bits)) return (0);
	if (upseudoprime_pretest(prime, 4093, bits)) return (0);
	if (upseudoprime_pretest(prime, 4099, bits)) return (0);
	if (upseudoprime_pretest(prime, 4111, bits)) return (0);
	if (upseudoprime_pretest(prime, 4127, bits)) return (0);
	if (upseudoprime_pretest(prime, 4129, bits)) return (0);
	if (upseudoprime_pretest(prime, 4133, bits)) return (0);
	if (upseudoprime_pretest(prime, 4139, bits)) return (0);
	if (upseudoprime_pretest(prime, 4153, bits)) return (0);
	if (upseudoprime_pretest(prime, 4157, bits)) return (0);
	if (upseudoprime_pretest(prime, 4159, bits)) return (0);
	if (upseudoprime_pretest(prime, 4177, bits)) return (0);
	if (upseudoprime_pretest(prime, 4201, bits)) return (0);
	if (upseudoprime_pretest(prime, 4211, bits)) return (0);
	if (upseudoprime_pretest(prime, 4217, bits)) return (0);
	if (upseudoprime_pretest(prime, 4219, bits)) return (0);
	if (upseudoprime_pretest(prime, 4229, bits)) return (0);
	if (upseudoprime_pretest(prime, 4231, bits)) return (0);
	if (upseudoprime_pretest(prime, 4241, bits)) return (0);
	if (upseudoprime_pretest(prime, 4243, bits)) return (0);
	if (upseudoprime_pretest(prime, 4253, bits)) return (0);
	if (upseudoprime_pretest(prime, 4259, bits)) return (0);
	if (upseudoprime_pretest(prime, 4261, bits)) return (0);
	if (upseudoprime_pretest(prime, 4271, bits)) return (0);
	if (upseudoprime_pretest(prime, 4273, bits)) return (0);
	if (upseudoprime_pretest(prime, 4283, bits)) return (0);
	if (upseudoprime_pretest(prime, 4289, bits)) return (0);
	if (upseudoprime_pretest(prime, 4297, bits)) return (0);
	if (upseudoprime_pretest(prime, 4327, bits)) return (0);
	if (upseudoprime_pretest(prime, 4337, bits)) return (0);
	if (upseudoprime_pretest(prime, 4339, bits)) return (0);
	if (upseudoprime_pretest(prime, 4349, bits)) return (0);
	if (upseudoprime_pretest(prime, 4357, bits)) return (0);
	if (upseudoprime_pretest(prime, 4363, bits)) return (0);
	if (upseudoprime_pretest(prime, 4373, bits)) return (0);
	if (upseudoprime_pretest(prime, 4391, bits)) return (0);
	if (upseudoprime_pretest(prime, 4397, bits)) return (0);
	if (upseudoprime_pretest(prime, 4409, bits)) return (0);
	if (upseudoprime_pretest(prime, 4421, bits)) return (0);
	if (upseudoprime_pretest(prime, 4423, bits)) return (0);
	if (upseudoprime_pretest(prime, 4441, bits)) return (0);
	if (upseudoprime_pretest(prime, 4447, bits)) return (0);
	if (upseudoprime_pretest(prime, 4451, bits)) return (0);
	if (upseudoprime_pretest(prime, 4457, bits)) return (0);
	if (upseudoprime_pretest(prime, 4463, bits)) return (0);
	if (upseudoprime_pretest(prime, 4481, bits)) return (0);
	if (upseudoprime_pretest(prime, 4483, bits)) return (0);
	if (upseudoprime_pretest(prime, 4493, bits)) return (0);
	if (upseudoprime_pretest(prime, 4507, bits)) return (0);
	if (upseudoprime_pretest(prime, 4513, bits)) return (0);
	if (upseudoprime_pretest(prime, 4517, bits)) return (0);
	if (upseudoprime_pretest(prime, 4519, bits)) return (0);
	if (upseudoprime_pretest(prime, 4523, bits)) return (0);
	if (upseudoprime_pretest(prime, 4547, bits)) return (0);
	if (upseudoprime_pretest(prime, 4549, bits)) return (0);
	if (upseudoprime_pretest(prime, 4561, bits)) return (0);
	if (upseudoprime_pretest(prime, 4567, bits)) return (0);
	if (upseudoprime_pretest(prime, 4583, bits)) return (0);
	if (upseudoprime_pretest(prime, 4591, bits)) return (0);
	if (upseudoprime_pretest(prime, 4597, bits)) return (0);
	if (upseudoprime_pretest(prime, 4603, bits)) return (0);
	if (upseudoprime_pretest(prime, 4621, bits)) return (0);
	if (upseudoprime_pretest(prime, 4637, bits)) return (0);
	if (upseudoprime_pretest(prime, 4639, bits)) return (0);
	if (upseudoprime_pretest(prime, 4643, bits)) return (0);
	if (upseudoprime_pretest(prime, 4649, bits)) return (0);
	if (upseudoprime_pretest(prime, 4651, bits)) return (0);
	if (upseudoprime_pretest(prime, 4657, bits)) return (0);
	if (upseudoprime_pretest(prime, 4663, bits)) return (0);
	if (upseudoprime_pretest(prime, 4673, bits)) return (0);
	if (upseudoprime_pretest(prime, 4679, bits)) return (0);
	if (upseudoprime_pretest(prime, 4691, bits)) return (0);
	if (upseudoprime_pretest(prime, 4703, bits)) return (0);
	if (upseudoprime_pretest(prime, 4721, bits)) return (0);
	if (upseudoprime_pretest(prime, 4723, bits)) return (0);
	if (upseudoprime_pretest(prime, 4729, bits)) return (0);
	if (upseudoprime_pretest(prime, 4733, bits)) return (0);
	if (upseudoprime_pretest(prime, 4751, bits)) return (0);
	if (upseudoprime_pretest(prime, 4759, bits)) return (0);
	if (upseudoprime_pretest(prime, 4783, bits)) return (0);
	if (upseudoprime_pretest(prime, 4787, bits)) return (0);
	if (upseudoprime_pretest(prime, 4789, bits)) return (0);
	if (upseudoprime_pretest(prime, 4793, bits)) return (0);
	if (upseudoprime_pretest(prime, 4799, bits)) return (0);
	if (upseudoprime_pretest(prime, 4801, bits)) return (0);
	if (upseudoprime_pretest(prime, 4813, bits)) return (0);
	if (upseudoprime_pretest(prime, 4817, bits)) return (0);
	if (upseudoprime_pretest(prime, 4831, bits)) return (0);
	if (upseudoprime_pretest(prime, 4861, bits)) return (0);
	if (upseudoprime_pretest(prime, 4871, bits)) return (0);
	if (upseudoprime_pretest(prime, 4877, bits)) return (0);
	if (upseudoprime_pretest(prime, 4889, bits)) return (0);
	if (upseudoprime_pretest(prime, 4903, bits)) return (0);
	if (upseudoprime_pretest(prime, 4909, bits)) return (0);
	if (upseudoprime_pretest(prime, 4919, bits)) return (0);
	if (upseudoprime_pretest(prime, 4931, bits)) return (0);
	if (upseudoprime_pretest(prime, 4933, bits)) return (0);
	if (upseudoprime_pretest(prime, 4937, bits)) return (0);
	if (upseudoprime_pretest(prime, 4943, bits)) return (0);
	if (upseudoprime_pretest(prime, 4951, bits)) return (0);
	if (upseudoprime_pretest(prime, 4957, bits)) return (0);
	if (upseudoprime_pretest(prime, 4967, bits)) return (0);
	if (upseudoprime_pretest(prime, 4969, bits)) return (0);
	if (upseudoprime_pretest(prime, 4973, bits)) return (0);
	if (upseudoprime_pretest(prime, 4987, bits)) return (0);
	if (upseudoprime_pretest(prime, 4993, bits)) return (0);
	if (upseudoprime_pretest(prime, 4999, bits)) return (0);

	u(a, bits); urand(a, 32);
	u(one, bits); one[0] = 1;
	u(psubone, bits); usub(prime, one, psubone, bits);
	u(result, bits);
	umodexp(a, psubone, prime, result, bits);
	if (ueq(result, one, bits)) { return (1); }
	return (0);
}

uint8_t upseudoprime_test_32(uint32_t *prime, size_t bits) {
	for (size_t i = 0; i < 4; i++) {
		if (!upseudoprime_test(prime, bits))
			return (0);
	}
	return (1);
}

void upseudoprime(uint32_t *result, size_t size, size_t bits) {
	do {
		urand(result, size); 
		if (upseudoprime_test_32(result, bits)) return;
	} while (1);
}
